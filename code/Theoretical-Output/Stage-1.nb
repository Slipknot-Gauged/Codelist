(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14190,        342]
NotebookOptionsPosition[     13450,        323]
NotebookOutlinePosition[     13862,        340]
CellTagsIndexPosition[     13819,        337]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"unit", ":", "mm"}], "*)"}]], "Input",
 CellChangeTimes->{{3.930647600493601*^9, 3.930647607954826*^9}, {
  3.9307143600775604`*^9, 
  3.9307143619072514`*^9}},ExpressionUUID->"2e62b79d-a296-f24f-93d7-\
03bfbc8d312e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"OPTIONAL", ":", " ", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "align", " ", "at", " ", "the", " ", 
      "peak", " ", "force", " ", "in", " ", "the", " ", "force"}], "-", 
     RowBox[{
     "displacement", " ", "curve", " ", "in", " ", "Fig", ".2", "d"}]}]}], 
   ",", 
   RowBox[{
   "a", " ", "constant", " ", "xdiv", " ", "can", " ", "be", " ", "uniformly",
     " ", "added", " ", "to", " ", "the", " ", "output", " ", "abscissa"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9307143653932858`*^9, 3.930714370213064*^9}, {
  3.9307144222221413`*^9, 
  3.9307145347300873`*^9}},ExpressionUUID->"cca7b392-7a5a-2d4a-8090-\
0f155c35a974"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DD", "=", 
    RowBox[{"235", "/", "1000"}]}], ";", 
   RowBox[{"sp", "=", "25"}], ";", 
   RowBox[{"t0", "=", "1"}], ";", 
   RowBox[{"sL", "=", "50"}], ";", 
   RowBox[{"Me", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", 
   RowBox[{"mu", "=", 
    RowBox[{"16", "/", "100"}]}], ";", 
   RowBox[{"d0", "=", "DD"}], ";", 
   RowBox[{"EI", "=", 
    RowBox[{"2700", "*", "Pi", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d0", "^", "4"}], ")"}], "/", "64"}]}]}], ";", 
   RowBox[{"\[Theta]0", "=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"(", "d0", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "DD"}], ")"}]}], "]"}]}], ";", 
   RowBox[{"Me", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"\:5355\:4f4d", "\:ff1a", "mm"}], "*)"}], ";", 
  RowBox[{"Fc", "=", 
   RowBox[{"14", "/", "10"}]}], ";", 
  RowBox[{"xdiv", "=", 
   RowBox[{"-", "40.24161"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.9155080887602167`*^9, {3.9155126638133464`*^9, 3.915512667724429*^9}, {
   3.9155179420079*^9, 3.915517956009862*^9}, 3.915518353090113*^9, 
   3.9155198428136244`*^9, 3.915521484145715*^9, 3.915521544971389*^9, {
   3.9155272042477694`*^9, 3.9155272044978113`*^9}, {3.915527250639328*^9, 
   3.915527250916451*^9}, {3.915679171475037*^9, 3.915679225613192*^9}, {
   3.915679283635132*^9, 3.9156792852672224`*^9}, {3.915679341815934*^9, 
   3.915679375753497*^9}, 3.915679439343287*^9, {3.9156796079986587`*^9, 
   3.915679608155892*^9}, 3.915679749104999*^9, 3.915679842985293*^9, {
   3.916132753770033*^9, 3.916132754443512*^9}, {3.916132843777604*^9, 
   3.9161328454819756`*^9}, {3.91776610963343*^9, 3.917766110950541*^9}, {
   3.917766331616935*^9, 3.917766331742097*^9}, {3.917766736158427*^9, 
   3.917766736597245*^9}, {3.9177673055905857`*^9, 3.917767305779147*^9}, 
   3.917771247137685*^9, {3.917852639105416*^9, 3.917852675923156*^9}, {
   3.9178529117779326`*^9, 3.917852919457637*^9}, {3.9178552717022448`*^9, 
   3.917855280560272*^9}, {3.917856194555343*^9, 3.9178561957464743`*^9}, 
   3.917856822548989*^9, {3.9178569945473757`*^9, 3.917857049299231*^9}, {
   3.9178570945041475`*^9, 3.917857170385033*^9}, {3.917857247393343*^9, 
   3.917857247570237*^9}, 3.9178576210019145`*^9, {3.917918767176796*^9, 
   3.917918773158742*^9}, {3.917928352413677*^9, 3.917928352648532*^9}, {
   3.918007608073335*^9, 3.918007608299908*^9}, {3.918007862187347*^9, 
   3.918007862351512*^9}, {3.918007997511113*^9, 3.9180079977190638`*^9}, {
   3.918008098438131*^9, 3.918008102639701*^9}, {3.923211875720869*^9, 
   3.923211932784506*^9}, 3.9232125065717936`*^9, 3.9232131690364385`*^9, {
   3.923213326784818*^9, 3.92321332721449*^9}, {3.923213424748933*^9, 
   3.9232134259371443`*^9}, {3.930646764095859*^9, 3.9306467806503143`*^9}, {
   3.930646887057722*^9, 3.930646946804018*^9}, {3.930647026800905*^9, 
   3.930647037056242*^9}, 3.930647136290661*^9, {3.9307145070195656`*^9, 
   3.930714510552765*^9}, {3.9307146413768005`*^9, 
   3.9307146442468395`*^9}},ExpressionUUID->"2afa84cb-01cd-48fd-b04b-\
cf3a08b6c425"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"sm", "=", "nn"}], ";", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "sol1", ",", "G", ",", "TT", ",", "sol2", ",", "\[Phi]fin", ",", "x0", 
      ",", "xx", ",", "dtfx", ",", "fxx", ",", "xmin"}], "]"}], ";", 
    RowBox[{"sol1", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]1", "''"}], "[", "s", "]"}], "-", 
           RowBox[{
            RowBox[{"g", "[", "s", "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "s", "]"}], "]"}]}]}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "'"}], "[", "s", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x1", "'"}], "[", "s", "]"}], "==", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "s", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "0", "]"}], "==", "Pi"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "sm", "]"}], "==", "\[Theta]0"}], ",", 
         RowBox[{
          RowBox[{"x1", "[", "0", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"x1", "[", "sm", "]"}], "==", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]1", ",", 
         RowBox[{"\[Phi]1", "'"}], ",", "g"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "sm"}], "}"}], ",", 
       RowBox[{"Method", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Shooting\>\"", ",", 
          RowBox[{"\"\<StartingInitialConditions\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]1", "[", "0", "]"}], "\[Equal]", "Pi"}], ",", 
             RowBox[{
              RowBox[{"g", "[", "0", "]"}], "==", 
              RowBox[{"1", "/", "100"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Phi]1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}],
             "}"}]}], ",", 
          RowBox[{"MaxIterations", "->", "20000"}]}], "}"}]}], ",", 
       RowBox[{"AccuracyGoal", "->", "20"}], ",", 
       RowBox[{"PrecisionGoal", "->", "20"}], ",", 
       RowBox[{"WorkingPrecision", "->", "36"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"G", "[", "s_", "]"}], ":=", 
     RowBox[{"EI", "*", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"g", "/.", 
         RowBox[{"sol1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "s", "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"TT", "[", "s_", "]"}], ":=", 
     RowBox[{"Fc", "+", 
      RowBox[{"G", "[", "s", "]"}]}]}], ";", 
    RowBox[{"sol2", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]2", "''"}], "[", "s", "]"}], "-", 
           RowBox[{
            RowBox[{"TT", "[", "sm", "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "s", "]"}], "]"}]}]}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "sm", "]"}], "==", "\[Theta]0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]2", "'"}], "[", "sp", "]"}], "==", "0"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]2", ",", 
         RowBox[{"\[Phi]2", "'"}], ",", "t"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "sm", ",", "sp"}], "}"}], ",", 
       RowBox[{"Method", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Shooting\>\"", ",", 
          RowBox[{"\"\<StartingInitialConditions\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]2", "[", "sp", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Phi]2", "'"}], "[", "sp", "]"}], "\[Equal]", 
              "0"}]}], "}"}]}], ",", 
          RowBox[{"MaxIterations", "->", "10000"}]}], "}"}]}], ",", 
       RowBox[{"PrecisionGoal", "->", "20"}], ",", 
       RowBox[{"AccuracyGoal", "->", "20"}], ",", 
       RowBox[{"WorkingPrecision", "->", "36"}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"\[Phi]fin", "[", "s_", "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Phi]1", "/.", 
             RowBox[{"sol1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "s", "]"}], ",", 
          RowBox[{"0", "<=", "s", "<", "sm"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"\[Phi]2", "/.", 
             RowBox[{"sol2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "s", "]"}], ",", 
          RowBox[{"sm", "<=", "s", "<=", "sp"}]}], "}"}]}], "}"}], "]"}]}], 
    ";", 
    RowBox[{"x0", "=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]fin", "[", "s", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", "sp"}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "->", "30"}]}], "]"}]}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"N", "[", "nn", "]"}], ",", 
       RowBox[{"x0", "+", "sL", "-", "sp"}], 
       RowBox[{"(*", 
        RowBox[{"+", "xdiv"}], "*)"}], ",", 
       RowBox[{"TT", "[", "sm", "]"}]}], "}"}], "]"}], ";", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"Me", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"N", "[", "nn", "]"}], ",", 
        RowBox[{"x0", "+", "sL", "-", "sp"}], 
        RowBox[{"(*", 
         RowBox[{"+", "xdiv"}], "*)"}], ",", 
        RowBox[{"TT", "[", "sm", "]"}]}], "}"}]}], "]"}], ";"}], ",", 
   RowBox[{"{", 
    RowBox[{"nn", ",", "10", ",", "8", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "10"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.915512048178295*^9, 3.915512087663217*^9}, {
   3.9155121921010437`*^9, 3.915512207348852*^9}, {3.915512739462968*^9, 
   3.915512770531103*^9}, {3.915512838800299*^9, 3.915512917924399*^9}, {
   3.915512991359598*^9, 3.915513016099638*^9}, 3.9155130466101074`*^9, {
   3.915518010179969*^9, 3.915518039928472*^9}, {3.91551835962521*^9, 
   3.915518388836158*^9}, 3.915520050511752*^9, {3.915521530936056*^9, 
   3.915521531235031*^9}, {3.915525697327844*^9, 3.915525700176642*^9}, {
   3.9156794479774675`*^9, 3.915679466780405*^9}, {3.91567996272485*^9, 
   3.915680039161775*^9}, {3.9177671723950415`*^9, 3.917767174365573*^9}, {
   3.917767317816041*^9, 3.9177673257091274`*^9}, {3.917852724062684*^9, 
   3.9178527836959534`*^9}, {3.917852943141419*^9, 3.917852949451243*^9}, {
   3.917853053044964*^9, 3.917853081278556*^9}, {3.917853125943152*^9, 
   3.917853129606588*^9}, {3.917856241979738*^9, 3.9178562756313424`*^9}, {
   3.917856833259245*^9, 3.91785687984626*^9}, {3.917857255363457*^9, 
   3.917857256931875*^9}, {3.917857454937454*^9, 3.917857456820277*^9}, {
   3.917857627302123*^9, 3.917857641204164*^9}, 3.91785781863199*^9, {
   3.917858095836574*^9, 3.9178580993335896`*^9}, {3.918007640236002*^9, 
   3.918007723669653*^9}, {3.9180077845030766`*^9, 3.918007812236863*^9}, 
   3.9180078872704053`*^9, {3.918008009434555*^9, 3.9180080164308467`*^9}, {
   3.918008071000028*^9, 3.918008123734576*^9}, {3.918008720321224*^9, 
   3.9180087273327346`*^9}, {3.923211997048184*^9, 3.9232120100945797`*^9}, {
   3.923212142965004*^9, 3.923212152574479*^9}, {3.923212214362059*^9, 
   3.9232122152104845`*^9}, 3.923212556576312*^9, {3.9232128783959455`*^9, 
   3.923212880687517*^9}, {3.923213132148843*^9, 3.923213135513129*^9}, {
   3.923213182664233*^9, 3.923213185061219*^9}, {3.9232133330555725`*^9, 
   3.923213335216165*^9}, {3.923213477074325*^9, 3.923213477612713*^9}, 
   3.9232135486702046`*^9, {3.930647105591343*^9, 3.9306471246978674`*^9}, 
   3.930647172717209*^9, {3.930647492948164*^9, 3.9306474961963387`*^9}, {
   3.930714655646244*^9, 
   3.9307146662783985`*^9}},ExpressionUUID->"44ad6799-4247-4475-b9c9-\
af03b05bb52a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<Stage-1.xlsx\>\"", ",", "Me"}], "]"}], ";", 
  RowBox[{"SystemOpen", "[", "\"\<Stage-1.xlsx\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.9155182281101465`*^9, 3.915518246200107*^9}, {
  3.9306477221523666`*^9, 3.930647726120611*^9}, {3.9306483196844196`*^9, 
  3.9306483251943207`*^9}},ExpressionUUID->"6b65be1a-88f1-41ec-96a6-\
294971fc4637"]
},
WindowSize->{1269, 641},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (2023\:5e7412\:670812\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e0e9b5e4-599b-4780-9d22-77e8737f2d6b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 257, 6, 28, "Input",ExpressionUUID->"2e62b79d-a296-f24f-93d7-03bfbc8d312e"],
Cell[818, 28, 723, 18, 28, "Input",ExpressionUUID->"cca7b392-7a5a-2d4a-8090-0f155c35a974"],
Cell[1544, 48, 3233, 66, 271, "Input",ExpressionUUID->"2afa84cb-01cd-48fd-b04b-cf3a08b6c425"],
Cell[4780, 116, 8252, 195, 451, "Input",ExpressionUUID->"44ad6799-4247-4475-b9c9-af03b05bb52a"],
Cell[13035, 313, 411, 8, 43, "Input",ExpressionUUID->"6b65be1a-88f1-41ec-96a6-294971fc4637"]
}
]
*)

